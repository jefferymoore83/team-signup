<!DOCTYPE html>
<html>
<head>
  <% include ../partials/header.ejs %>
  <script>
  var config = { is_admin: <%= user.is_admin %> }
  </script>
</head>

<body>

  <h1><%= app.name %></h1>

  <% if (user.is_admin) { %>
    <h2>Admin Tools:</h2>
    <a href="/api/admin/reset" data-api-action>Reset Teams &gt;</a>
  <% } %>

  <% if (user.full_name || user.is_admin) { %>
    <h3>Hi, <%= user.full_name || 'admin' %>!</h3>
    <% if (!user.is_admin) { %>
      <a href="/api/setname?full_name=" data-api-action>Clear Name</a>
    <%  } %>

    <% if (app.config.devMode) { %>
      <p><em>my guid: <%= user.guid %></em></p>
    <% } %>

    <h2>The following teams are available to join:</h2>

    <ul class="team-signup__team-listing">
        <% teams.forEach(function(team){ %>
          <li data-team-id="<%= team.id %>">
            <%- include('../partials/team.ejs', { team }); %>
          </li>
        <% }); %>
    </ul>
  <% } else { %>
    <form action="/api/setname" method="GET" data-form-name="enter-name">
      <h3>Enter your full name please.</h3>
      <input name="full_name" placeholder="Enter full name" class="team-signup__name-entry" >
      <input type="submit" value="Submit" />
    </form>
  <% } %>

  <% if (app.config.devMode) { %>
    <script src="<%= app.config.browserRefreshURL %>"></script>
  <% } %>  

  <script src="/assets/js/app.js"></script>
</body>
</html>
